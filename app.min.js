document.addEventListener("DOMContentLoaded",function(){var t=function(t){var e=t||{};this.baseUrl=e.baseUrl,this.apiKey=e.apiKey,this.searchQuery=e.searchQuery,this.imageCount=e.imageCount,this.contentNode=document.querySelector(".content"),this.gridNode=this.contentNode.querySelector(".grid"),this.lightboxNode=document.querySelector(".lightbox"),this.lightboxImageNode=this.lightboxNode.querySelector(".lightbox-image"),this.selectedIndex=0,this.lightboxEnabled=!1,this.apiImages=[]};t.prototype.toggleLightbox=function(){this.lightboxEnabled=!this.lightboxEnabled,this.lightboxNode.classList.toggle("active")},t.prototype.trimAltText=function(t){return t.substr(0,100)},t.prototype.selectLightboxImage=function(t){var e=this.apiImages[t];this.lightboxImageNode.src=e.url_m||e.url_o,this.lightboxImageNode.alt=this.trimAltText(e.title),this.selectedIndex=t,this.lightboxEnabled||this.toggleLightbox()},t.prototype.showError=function(t){this.contentNode.classList.add("error"),console.log("Error: "+t)},t.prototype.generateImageTileTemplate=function(t,e){return'<div class="tile" data-index="'+e+'"><img class="tile-image hidden" src="'+t.url_t+'" height="'+t.height_t+'" width='+t.width_t+'" alt="'+this.trimAltText(t.title)+'"></div>'},t.prototype.processImages=function(t){var e=[];t.forEach(function(t,i){e.push(this.generateImageTileTemplate(t,i))}.bind(this)),this.apiImages=t,this.gridNode.innerHTML=e.join(""),this.contentNode.classList.remove("loading")},t.prototype.handleDOMEvents=function(){this.gridNode.addEventListener("load",function(t){var e=t.target;e.matches(".hidden")&&e.classList.remove("hidden")},!0),this.gridNode.addEventListener("click",function(t){var e,i=t.target;if(i.matches(".tile-image"))e=i.parentNode;else{if(!i.matches(".tile"))return;e=i}var s=parseInt(e.getAttribute("data-index"));this.selectLightboxImage(s)}.bind(this)),this.lightboxNode.addEventListener("click",function(t){var e=t.target,i=t.currentTarget;e===i||e.parentNode===i?this.toggleLightbox():e.matches(".lightbox-prev")?0===this.selectedIndex?this.selectLightboxImage(this.imageCount-1):this.selectLightboxImage(this.selectedIndex-1):e.matches(".lightbox-next")&&(this.selectedIndex===this.imageCount-1?this.selectLightboxImage(0):this.selectLightboxImage(this.selectedIndex+1))}.bind(this))},t.prototype.requestImages=function(t,e){var i=new XMLHttpRequest,s=this.baseUrl+"&text="+this.searchQuery+"&per_page="+this.imageCount+"&api_key="+this.apiKey;i.addEventListener("readystatechange",function(){if(4===i.readyState)if(200===i.status){var s;try{s=JSON.parse(i.responseText)}catch(o){return void e.call(this,o.toString())}"ok"===s.stat?t.call(this,s.photos.photo):e.call(this,s.message)}else e.call(this,"API Error")}.bind(this)),i.open("GET",s,!0),i.send()},t.prototype.init=function(){this.handleDOMEvents(),this.requestImages(this.processImages,this.showError)};var e={apiKey:"2b7873498ef5d013f601c53d9dff05f2",baseUrl:"https://api.flickr.com/services/rest/?method=flickr.photos.search&format=json&nojsoncallback=1&extras=url_t,url_m,url_o",imageCount:150,searchQuery:"olympics"},i=new t(e);i.init()});